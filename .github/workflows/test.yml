name: test

permissions:
  contents: write
  id-token: write
  pull-requests: write
  issues: write


on:
  issue_comment:
    type:
      - created
      - edited


jobs:
  test:
    if: (github.event.comment.body != 'approved')
    runs-on: ubuntu-latest

    steps:
      - name: setup python
        uses: actions/setup-python@2.2.2
        with:
          python-version: 3.11
      - name: test
        env: 
          BODY: ${{toJson(github.event.issue.body)}}
          # BODY: ${{ github.event.issue.body }}

        run: |
          echo "--------------------------"
          echo $0
          echo -e "a"
          a="$PWD"
          echo $a
          
          echo "--------------------------"
          echo "BODY"
          echo $BODY
          envar=$(echo -e "$BODY" | sed -n 3p )
          echo "Envar"
          echo $envar
          ls -la
          sudo python test.py $envar
                  
